---
lp: 300
title: Fully Homomorphic Encryption (FHE) Strategy
description: Independent, patent-safe FHE implementation for confidential blockchain computation
author: Lux Research
status: Final
type: Standards Track
category: Cryptography
created: 2024-12-27
---

## Abstract

This LP defines Lux Network's Fully Homomorphic Encryption (FHE) strategy, documenting our independent Go-based TFHE implementation built from first principles to avoid patent encumbrance while delivering superior performance and blockchain-native design.

## Motivation

### Greenfield Implementation

Lux Industries chose to implement TFHE from first principles in Go, based solely on published academic research. This ensures:

1. **Independence**: No dependencies on third-party FHE implementations
2. **Academic Foundation**: Built on peer-reviewed cryptographic research
3. **Full Control**: Complete ownership of our cryptographic stack
4. **Blockchain-Native**: Designed specifically for blockchain use cases

## Specification

### 1. Independent TFHE Implementation

**Repository**: `github.com/luxfi/tfhe`

**Key Characteristics**:
- **Pure Go**: No CGO dependencies, compiles anywhere Go runs
- **Original Code**: Written from scratch, not derived from any existing implementation
- **Academic Foundation**: Based on peer-reviewed publications only:
  - Chillotti et al. "TFHE: Fast Fully Homomorphic Encryption Over the Torus" (Journal of Cryptology, 2020)
  - Ducas & Micciancio "FHEW: Bootstrapping Homomorphic Encryption in Less Than a Second" (EUROCRYPT 2015)

**Technology Stack**:
```
github.com/luxfi/tfhe          <- TFHE operations
    └── github.com/luxfi/lattice   <- Custom lattice crypto library
        └── Standard Go crypto      <- No external dependencies
```

### 2. Performance Comparison

| Operation | Lux Go TFHE | OpenFHE (CGO) | Advantage |
|-----------|-------------|---------------|-----------|
| Bootstrap Key Gen | 132 ms | 2,413 ms | **18x faster** |
| Boolean Gate (AND) | 51 ms | 56 ms | 1.10x faster |
| Boolean Gate (XOR) | 51 ms | 56 ms | 1.10x faster |
| Encrypt Bit | 21 µs | 28 µs | 1.3x faster |
| NOT Gate | 1.2 µs | 1.4 µs | ~Same |

**Platform**: Apple M1 Max

### 3. Blockchain-Native Design

| Type | Bits | Use Case |
|------|------|----------|
| FheBool | 1 | Boolean flags, comparisons |
| FheUint8 | 8 | Bytes, small values |
| FheUint32 | 32 | Standard integers |
| FheUint64 | 64 | Large integers |
| FheUint128 | 128 | UUIDs |
| **FheUint160** | 160 | **Ethereum addresses** |
| **FheUint256** | 256 | **EVM word size** |

### 4. Patent Portfolio

Lux Industries has filed patent applications for novel innovations developed independently:

| Patent ID | Title | Innovation |
|-----------|-------|------------|
| PAT-FHE-001 | Consensus-Integrated Threshold FHE | Decryption shares in consensus votes |
| PAT-FHE-002 | Deterministic FHE RNG | Blockchain-compatible random numbers |
| PAT-FHE-003 | Transaction-Batch Amortized Bootstrapping | Block-level optimization |
| PAT-FHE-004 | Lazy Carry Propagation | Deterministic noise tracking |
| PAT-FHE-005 | Batch DAG Execution | GPU-accelerated FHE ops |
| PAT-FHE-006 | GPU Backend Abstraction | Multi-vendor GPU support |
| PAT-FHE-007 | Packed Device Formats | Memory-efficient ciphertext |
| PAT-FHE-008 | Multi-GPU Coordination | Distributed FHE compute |
| PAT-FHE-009 | Gas Metering | Variable-cost FHE precompiles |

### 5. Licensing Model

**Lux Research License with Patent Reservation**:

| Use Case | License Required | Cost |
|----------|-----------------|------|
| Research/Academic | ✅ Free | $0 |
| Lux Network Mainnet | ✅ Free | $0 |
| Lux Network Testnet | ✅ Free | $0 |
| Other Commercial | Commercial License | Contact |

This model:
- Encourages academic research and peer review
- Protects Lux Network ecosystem
- Prevents competitors from free-riding on our investment
- Mirrors successful models (MySQL, Qt, etc.)

## Rationale

### Why Not Use Existing Libraries?

1. **Patent Risk**: [third-party]'s active litigation demonstrates real legal exposure
2. **Licensing Uncertainty**: Commercial use requires negotiation with uncertain outcomes
3. **Dependency Risk**: Reliance on third-party codebase for critical infrastructure
4. **Performance**: Our implementation is faster due to Go's compilation and our optimizations
5. **Integration**: Native Go enables seamless Lux node integration without CGO complexity

### Why Go?

1. **Determinism**: Critical for blockchain consensus - same inputs produce same outputs
2. **Cross-Platform**: Single binary deployment, no shared library dependencies
3. **Memory Safety**: Garbage collection prevents entire classes of vulnerabilities
4. **Concurrency**: Native goroutines for parallel FHE operations
5. **Ecosystem**: Matches Lux node implementation language

### Academic Basis

Our implementation uses techniques from published academic literature:
- **Boolean Gates**: FHEW bootstrapping (Ducas & Micciancio, 2015)
- **Programmable Bootstrapping**: TFHE scheme (Chillotti et al., 2020)
- **Ring-LWE**: Well-established lattice cryptography

These techniques predate recent patent filings and represent established cryptographic knowledge.

## Implementation

### fhEVM Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                      Lux fhEVM Stack                         │
├─────────────────────────────────────────────────────────────┤
│  Solidity Layer (lux/standard/contracts/fhe/)               │
│    ├── FHE.sol      - High-level encrypted types            │
│    ├── FheOS.sol    - Precompile interface                  │
│    └── Tokens/      - ConfidentialERC20, etc.               │
├─────────────────────────────────────────────────────────────┤
│  EVM Precompiles (lux/evm/precompile/contracts/fhe/)        │
│    ├── FheAdd, FheSub, FheMul   - Arithmetic                │
│    ├── FheEq, FheLt, FheGt      - Comparison                │
│    └── FheDecrypt               - Threshold decryption      │
├─────────────────────────────────────────────────────────────┤
│  Go TFHE Library (github.com/luxfi/tfhe)                    │
│    ├── Encryptor    - Public key encryption                 │
│    ├── Evaluator    - Homomorphic operations                │
│    └── Decryptor    - Secret key decryption                 │
├─────────────────────────────────────────────────────────────┤
│  Lattice Primitives (github.com/luxfi/lattice)              │
│    ├── RLWE         - Ring-LWE encryption                   │
│    ├── NTT          - Number theoretic transform            │
│    └── Sampling     - Gaussian/uniform sampling             │
└─────────────────────────────────────────────────────────────┘
```

### KMS Virtual Machine

The K-Chain VM (`lux/node/vms/kmsvm`) provides:
- Post-quantum key management (ML-KEM)
- Threshold key sharing
- Integration with consensus for decryption

## Security Considerations

1. **Implementation Security**: Code undergoes continuous testing and will receive third-party audit
2. **Parameter Security**: Using well-studied security parameters from literature
3. **Side-Channel Resistance**: Constant-time operations where cryptographically necessary
4. **Key Management**: Threshold scheme prevents single-point-of-failure

## Timeline

| Date | Milestone |
|------|-----------|
| 2024-Q3 | Initial Go TFHE implementation |
| 2024-Q4 | Patent portfolio filed |
| 2024-Q4 | Lattice library production-ready |
| 2025-Q1 | fhEVM precompiles integrated |
| 2025-Q2 | Testnet deployment |
| 2025-Q3 | Security audit |
| 2025-Q4 | Mainnet activation |

## Backwards Compatibility

This LP introduces new FHE capabilities and does not affect existing chain functionality. The implementation is additive and opt-in for applications requiring confidential computation.

## Security Considerations

FHE implementations must undergo cryptographic audit before mainnet deployment. Key security aspects:
- Parameter selection must ensure adequate security margins
- Key management follows existing chain security practices
- Bootstrapping key generation uses audited random number sources

## References

1. Chillotti, I., Gama, N., Georgieva, M., & Izabachène, M. (2020). "TFHE: Fast Fully Homomorphic Encryption Over the Torus." Journal of Cryptology.

2. Ducas, L., & Micciancio, D. (2015). "FHEW: Bootstrapping Homomorphic Encryption in Less Than a Second." EUROCRYPT 2015.

3. Rekt News. (2024, December 23). "Patently Absurd." https://rekt.news/patently-absurd

## Copyright

Copyright (c) 2024-2025 Lux Industries Inc. All rights reserved.
Patent rights reserved. See LICENSE for terms.
